{
  "type": "object",
  "properties": {
    "vulnerabilities": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"]
          },
          "title": { "type": "string" },
          "description": { "type": "string" }
        },
        "required": ["id", "severity", "title"]
      }
    },
    "fixes": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "vulnerability_id": { "type": "string" },
          "fix_type": {
            "type": "string",
            "enum": ["upgrade", "patch", "replace", "configuration", "remove"]
          },
          "recommended_version": { "type": "string" },
          "alternative_packages": {
            "type": "array",
            "items": { "type": "string" }
          },
          "fix_command": { "type": "string" },
          "risk_score": {
            "type": "number",
            "minimum": 1,
            "maximum": 10,
            "multipleOf": 0.1,
            "description": "Numerical risk score from 1-10 based on only the total vulnerabilities of the dependency, can use decimals in 0.1 increments."
          },
          "breaking_changes": { "type": "boolean" },
          "explanation": { 
            "type": "string",
            "description": "Concise explanation (atmost 4 sentences) of why this fix is recommended with proper context, focusing on risk mitigation and benefits."
          }
        },
        "required": [
          "vulnerability_id",
          "fix_type",
          "fix_command",
          "risk_score",
          "breaking_changes",
          "explanation"
        ]
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "critical_count": { "type": "integer" },
        "high_count": { "type": "integer" },
        "medium_count": { "type": "integer" },
        "low_count": { "type": "integer" },
        "overall_risk": {
          "type": "number",
          "minimum": 1,
          "maximum": 10,
          "multipleOf": 0.1,
          "description": "Final Numerical risk score from 1-10 based on all the vulnerabilities in the data, can use decimals in 0.1 increments."
        },
        "recommended_action": { "type": "string" },
        "urgency": {
          "type": "string",
          "pattern": "^(Within|In|By)\\s+(\\d+\\s+(Hours?|Days?|Weeks?|Months?)|Immediately|ASAP)$",
          "description": "Estimated timeline for fix implementation. Exactly three words, title case. Examples: 'Within 2 Days', 'Within 1 Week', 'Within X Hours'."
        }
      },
      "required": [
        "critical_count",
        "high_count",
        "medium_count",
        "low_count",
        "overall_risk",
        "recommended_action",
        "urgency"
      ]
    },
    "transitive_dependencies": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "version": { "type": "string" },
          "vulnerability_count": { "type": "integer" },
          "affects_parent": { "type": "boolean" },
          "fix_available": { "type": "boolean" }
        },
        "required": ["name", "version", "vulnerability_count"]
      }
    }
  },
  "required": ["vulnerabilities", "fixes", "summary"]
}
